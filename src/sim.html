<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluid Simulation</title>
    <link rel="stylesheet" href="simStyles.css">
    <!-- <link rel="icon" href="/images/favicon.png" type="image/png"> -->
</head>

<body>
    <canvas id="fluidCanvas"></canvas>
    <script src="./main4.js" type="module"></script>
    <script id="fragShader" type="shader-code">
		uniform vec2 res;//The width and height of our screen
		uniform sampler2D bufferTexture;//Our input texture
		uniform vec3 smokeSource;//The x,y are the posiiton. The z is the power/density
		void main() {
	        vec2 pixel = gl_FragCoord.xy / res.xy;
	        gl_FragColor = texture2D( bufferTexture, pixel );

	        //Get the distance of the current pixel from the smoke source
	        float dist = distance(smokeSource.xy,gl_FragCoord.xy);
	        //Generate smoke when mouse is pressed
			gl_FragColor.rgb += smokeSource.z * max(30.0-dist,0.0);
  
     //Smoke diffuse
	        float xPixel = 1.0/res.x;//The size of a single pixel
	        float yPixel = 1.0/res.y;
	        vec4 rightColor = texture2D(bufferTexture,vec2(pixel.x+xPixel,pixel.y));
	        vec4 leftColor = texture2D(bufferTexture,vec2(pixel.x-xPixel,pixel.y));
	        vec4 upColor = texture2D(bufferTexture,vec2(pixel.x,pixel.y+yPixel));
	        vec4 downColor = texture2D(bufferTexture,vec2(pixel.x,pixel.y-yPixel));
//Diffuse equation
	        float factor = 8.0 * 0.016 * (leftColor.r + rightColor.r + downColor.r * 3.0 + upColor.r - 6.0 * gl_FragColor.r);
		 
	        //Account for low precision of texels
	        float minimum = 0.003;
			if(factor >= -minimum && factor < 0.0) factor = -minimum;

			gl_FragColor.rgb += factor;
		 }
	</script>
    <!-- <script id="fragShader" src="./shaders/fragmentShader.glsl" type="shaderCode"></script> -->

    <p>
        <a href="index.html">Home Page</a>
    </p>
</body>

</html>